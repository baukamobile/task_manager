import{E as C,r as b,o as I,q as m,b as O,e as n,f,m as e,v as u,F as h,K as w,M as x,g as i,G as l,B as g,P as z}from"./index-DgFySzYa.js";import{_ as E}from"./PageWrapper-BMp7S2xO.js";import{g as L,a as M,u as N}from"./tasks-Cz6Lq1lb.js";import"./index-C88pvD_q.js";const P={class:"flex flex-col gap-4 md:flex-row md:items-center"},V={class:"dashboard"},F={class:"center"},q=["onDrop"],A={class:"status"},G={class:"status-name"},K={class:"status-name",style:{}},R=["onDragstart"],U={class:"time-part"},$={class:"add-task-container"},j={class:"add-list"},H={__name:"department",setup(J){const y={1:{priority_name:"НИЗКИЙ",color:"green"},2:{priority_name:"СРЕДНИЙ",color:"blue"},3:{priority_name:"ВЫСОКИЙ",color:"orange"},4:{priority_name:"КРИТИЧЕСКИЙ",color:"red"}},p=b([]),_=b([]);I(async()=>{p.value=await L(),_.value=await M(),console.log("Loading data",_.value)});function T(o,t){o.dataTransfer.dropEffect="move",o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("taskID",t.id.toString())}async function S(o,t){o.preventDefault();const r=parseInt(o.dataTransfer.getData("taskID"));try{await N(r,t);const s=p.value.find(d=>d.id===r);s&&(s.status=t)}catch(s){console.error("Ошибка при обновлении задачи:",s)}}function v(o){return new Date(o).toLocaleString("ru-RU",{day:"2-digit",month:"long",hour:"2-digit",minute:"2-digit"})}return(o,t)=>{const r=m("a-button"),s=m("PlusOutlined"),d=m("DeleteOutlined");return n(),O(E,null,{default:f(()=>[e("div",P,[e("div",V,[e("div",F,[(n(!0),u(h,null,w(_.value,c=>(n(),u("div",{key:c.id,onDrop:a=>S(a,c.id),class:"droppable",onDragover:t[0]||(t[0]=x(()=>{},["prevent"])),onDragenter:t[1]||(t[1]=x(()=>{},["prevent"]))},[e("div",A,[e("div",G,[e("h1",K,l(c.status_name),1)]),i(r,{type:"primary",style:{color:"white","background-color":"red"},onClick:o.handleClick},{default:f(()=>t[2]||(t[2]=[g("Удалит колонку")])),_:1},8,["onClick"])]),(n(!0),u(h,null,w(p.value.filter(a=>a.status==c.id),a=>{var D,k;return n(),u("div",{key:a.task_name,onDragstart:B=>T(B,a),draggable:"true",class:"draggable"},[e("p",null,[g(l(a.task_name)+" ",1),e("span",{style:z({color:(D=y[a.priority])==null?void 0:D.color})}," ("+l(((k=y[a.priority])==null?void 0:k.priority_name)||"Неизвестный")+") ",5)]),e("div",U,[e("p",null,"от "+l(v(a.start_date)),1),e("p",null,"до "+l(v(a.end_date)),1)])],40,R)}),128)),e("div",$,[t[3]||(t[3]=e("a",{href:"#",class:"add-task"},"Добавить Задачу",-1)),i(s,{style:{"font-size":"24px",color:"black"}})])],40,q))),128)),e("div",j,[i(d,{style:{"font-size":"24px",color:"red"}}),t[5]||(t[5]=e("a",{href:"#",style:{color:"black"}},"Добавить Колонку",-1)),i(r,{type:"primary",danger:""},{default:f(()=>[i(d),t[4]||(t[4]=g(" Удалить "))]),_:1})])])])])]),_:1})}}},Z=C(H,[["__scopeId","data-v-29de8c4f"]]);export{Z as default};
