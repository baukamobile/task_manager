import{r as o,o as _,N as g,E as j,I as G,v as d,e as p,m as n,a1 as O,P as C,U as R,x as r,j as a,G as E,V as b,a2 as u,B as z,W as $,F as M,J as N}from"./index-DAeheIOC.js";const F="http://127.0.0.1:8000/users/api/login",J="http://127.0.0.1:8000/users/api/register",W="http://127.0.0.1:8000/users/positions",Y="http://127.0.0.1:8000/users/department",q="http://127.0.0.1:8000/users/company";function H(){const I=o(""),v=o(""),l=o(!1),s=o(""),c=o(""),m=o(""),y=o(""),w=o([]),h=o([]),k=o([]),U=o(null),P=o(null),x=o(null),S=async()=>{var e,t;if(!I.value||!v.value){s.value="Email и пароль обязательны!";return}l.value=!0,s.value="";try{const T=(await g.post(`${F}/`,{email:I.value,password:v.value})).data.token;return localStorage.setItem("authToken",T),console.log("token",localStorage),g.defaults.headers.common.Authorization=`Bearer ${T}`,!0}catch(i){s.value=((t=(e=i.response)==null?void 0:e.data)==null?void 0:t.message)||"Ошибка авторизации"}finally{l.value=!1}},A=async()=>{var e,t;if(!I.value||!c.value||!m.value||!v.value||!y.value||!U.value||!P.value||!x.value)return s.value="Пожалуйста заполните все поля",!1;l.value=!0,s.value="";try{const i=await g.post(`${J}/`,{email:I.value,first_name:c.value,last_name:m.value,password:v.value,phone_number:y.value,position:U.value,department:P.value,company:x.value});return!0}catch(i){return s.value=((t=(e=i.response)==null?void 0:e.data)==null?void 0:t.message)||"Ошибка при регистрации",!1}finally{l.value=!1}},B=()=>{localStorage.removeItem("authToken"),delete g.defaults.headers.common.Authorization,window.location.reload()},f=async()=>{try{const e=await g.get(`${W}/`);return console.log("Загрука список должностей",e.data),e.data}catch(e){return console.error("Ошибка при получении проекта:",e),null}},D=async()=>{try{const e=await g.get(`${Y}/`);return console.log("Загрука список отделов"),e.data}catch(e){return console.error("Ошибка при получении проекта:",e),null}},L=async()=>{try{return(await g.get(`${q}/`)).data}catch(e){return console.log("Ошибка загрузки данные о компании"),e}},V=async()=>{await handleLogin()?router.push({name:"Dashboard"}):s.value="Ошибка входа. Проверьте данные."};return _(async()=>{try{const[e,t,i]=await Promise.allSettled([f(),D(),L()]);e.status==="fulfilled"&&(w.value=e.value),t.status==="fulfilled"&&(h.value=t.value),i.status=="fulfilled"&&(k.value=i.value),console.log("Данные загружены:",{position:e.value,department:t.value,company:i.value})}catch(e){console.error("Ошибка при загрузке данных:",e)}}),{email:I,first_name:c,last_name:m,phone_number:y,password:v,isLoading:l,position:w,company:k,department:h,handleLoginClick:V,register:A,login:S,logout:B,errorMessage:s,selectedPosition:U,selectedDepartment:P,selectedCompany:x,getDepartment:D,getCompany:L,getPosition:f}}const K={class:"container",id:"container"},Q={class:"form-container sign-up-container"},X={key:0,class:"errormes"},Z={style:{display:"flex","justify-content":"space-around"}},ee={style:{display:"flex","justify-content":"space-around"}},te={class:"register-form-user-info",style:{display:"flex","justify-content":"space-between"}},ne=["value"],ae=["value"],se=["value"],le=["disabled"],oe={class:"form-container sign-in-container"},re=["disabled"],ue={key:0,class:"errormes"},ie={__name:"signup",setup(I){const v=G(),{email:l,password:s,first_name:c,last_name:m,selectedPosition:y,selectedDepartment:w,selectedCompany:h,phone_number:k,isLoading:U,position:P,department:x,company:S,login:A,register:B,errorMessage:f}=H(),D=async()=>{f.value="",await B()&&v.push({name:"Dashboard"})},L=async()=>{await A()&&v.push({name:"Chat"})};return _(()=>{const V=document.getElementById("signUp"),e=document.getElementById("signIn"),t=document.getElementById("container");V.addEventListener("click",()=>{t.classList.add("right-panel-active")}),e.addEventListener("click",()=>{t.classList.remove("right-panel-active")})}),(V,e)=>(p(),d("div",null,[n("div",K,[n("div",Q,[n("form",{onSubmit:C(D,["prevent"])},[a(f)?(p(),d("p",X,E(a(f)),1)):R("",!0),n("div",Z,[r(n("input",{type:"email",placeholder:"Email","onUpdate:modelValue":e[0]||(e[0]=t=>u(l)?l.value=t:null),onInput:e[1]||(e[1]=t=>console.log("email:",a(l)))},null,544),[[b,a(l)]]),r(n("input",{type:"text",placeholder:"Имя","onUpdate:modelValue":e[2]||(e[2]=t=>u(c)?c.value=t:null),onInput:e[3]||(e[3]=t=>console.log("first name:",a(c)))},null,544),[[b,a(c)]])]),r(n("input",{type:"text",placeholder:"Фамилия","onUpdate:modelValue":e[4]||(e[4]=t=>u(m)?m.value=t:null),onInput:e[5]||(e[5]=t=>console.log("last name:",a(m)))},null,544),[[b,a(m)]]),n("div",ee,[r(n("input",{type:"password",placeholder:"Password","onUpdate:modelValue":e[6]||(e[6]=t=>u(s)?s.value=t:null),onInput:e[7]||(e[7]=t=>console.log("password:",a(s)))},null,544),[[b,a(s)]]),r(n("input",{type:"text",inputmode:"numeric",pattern:"[0-9]*","onUpdate:modelValue":e[8]||(e[8]=t=>u(k)?k.value=t:null),placeholder:"Номер телефона"},null,512),[[b,a(k)]])]),n("div",te,[e[14]||(e[14]=n("label",{class:"label-name"},"Должность",-1)),e[15]||(e[15]=z("asdasdsa ")),r(n("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>u(y)?y.value=t:null)},[(p(!0),d(M,null,N(a(P),t=>(p(),d("option",{key:t.id,value:t.id},E(t.position_name),9,ne))),128))],512),[[$,a(y)]]),e[16]||(e[16]=n("br",null,null,-1)),e[17]||(e[17]=n("label",{class:"label-name"},"Отдел",-1)),r(n("select",{"onUpdate:modelValue":e[10]||(e[10]=t=>u(w)?w.value=t:null)},[(p(!0),d(M,null,N(a(x),t=>(p(),d("option",{key:t.id,value:t.id},E(t.department_name)+" ("+E(t.department_head)+") ",9,ae))),128))],512),[[$,a(w)]])]),e[18]||(e[18]=n("br",null,null,-1)),e[19]||(e[19]=n("label",{class:"label-name"},"Организация",-1)),r(n("select",{"onUpdate:modelValue":e[11]||(e[11]=t=>u(h)?h.value=t:null)},[(p(!0),d(M,null,N(a(S),t=>(p(),d("option",{key:t.id,value:t.id},E(t.company_name),9,se))),128))],512),[[$,a(h)]]),e[20]||(e[20]=n("br",null,null,-1)),n("button",{type:"submit",disabled:a(U)}," Создать Аккаунт ",8,le)],32)]),n("div",oe,[n("form",{onSubmit:C(L,["prevent"])},[e[21]||(e[21]=n("h1",null,"Войти в Аккаунт",-1)),e[22]||(e[22]=n("br",null,null,-1)),r(n("input",{type:"email",placeholder:"Email","onUpdate:modelValue":e[12]||(e[12]=t=>u(l)?l.value=t:null)},null,512),[[b,a(l)]]),r(n("input",{type:"password",placeholder:"Пароль","onUpdate:modelValue":e[13]||(e[13]=t=>u(s)?s.value=t:null)},null,512),[[b,a(s)]]),e[23]||(e[23]=n("a",{href:"#"},"Забыли Пароль?",-1)),n("button",{type:"submit",disabled:a(U)},"Войти",8,re),a(f)?(p(),d("p",ue,E(a(f)),1)):R("",!0)],32)]),e[24]||(e[24]=O('<div class="overlay-container" data-v-833caf62><div class="overlay" data-v-833caf62><div class="overlay-panel overlay-left" data-v-833caf62><h1 data-v-833caf62>Аккаунт уже имеется?</h1><br data-v-833caf62><button class="ghost" id="signIn" data-v-833caf62>Войти</button></div><div class="overlay-panel overlay-right" data-v-833caf62><h1 data-v-833caf62>GuideJet TI!</h1><br data-v-833caf62><button class="ghost" id="signUp" data-v-833caf62>Регистрация</button></div></div></div>',1))])]))}},pe=j(ie,[["__scopeId","data-v-833caf62"]]);export{pe as default};
